<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Data types | Data Manipulation with SQL</title>
  <meta name="description" content="This book introduces essential SQL commands for data maninpulation, as well as presenting equivalent dplyr code for complex queries." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Data types | Data Manipulation with SQL" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book introduces essential SQL commands for data maninpulation, as well as presenting equivalent dplyr code for complex queries." />
  <meta name="github-repo" content="enixam/data-manipulation-sql" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Data types | Data Manipulation with SQL" />
  
  <meta name="twitter:description" content="This book introduces essential SQL commands for data maninpulation, as well as presenting equivalent dplyr code for complex queries." />
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-07-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="joining.html"/>
<link rel="next" href="solutions-to-sql-puzzles.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Manipulationn with SQL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="sql-basics.html"><a href="sql-basics.html"><i class="fa fa-check"></i><b>1</b> SQL basics</a><ul>
<li class="chapter" data-level="1.1" data-path="sql-basics.html"><a href="sql-basics.html#ddl"><i class="fa fa-check"></i><b>1.1</b> DDL</a><ul>
<li class="chapter" data-level="1.1.1" data-path="sql-basics.html"><a href="sql-basics.html#creating-tables"><i class="fa fa-check"></i><b>1.1.1</b> Creating tables</a></li>
<li class="chapter" data-level="1.1.2" data-path="sql-basics.html"><a href="sql-basics.html#deleting-tables"><i class="fa fa-check"></i><b>1.1.2</b> Deleting tables</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sql-basics.html"><a href="sql-basics.html#dml"><i class="fa fa-check"></i><b>1.2</b> DML</a><ul>
<li class="chapter" data-level="1.2.1" data-path="sql-basics.html"><a href="sql-basics.html#inserting-rows"><i class="fa fa-check"></i><b>1.2.1</b> Inserting rows</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sql-basics.html"><a href="sql-basics.html#creating-views"><i class="fa fa-check"></i><b>1.3</b> Creating views</a><ul>
<li class="chapter" data-level="1.3.1" data-path="sql-basics.html"><a href="sql-basics.html#deleting-views"><i class="fa fa-check"></i><b>1.3.1</b> Deleting views</a></li>
<li class="chapter" data-level="1.3.2" data-path="sql-basics.html"><a href="sql-basics.html#updating-views"><i class="fa fa-check"></i><b>1.3.2</b> Updating views</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="write-simple-queries.html"><a href="write-simple-queries.html"><i class="fa fa-check"></i><b>2</b> Write simple queries</a><ul>
<li class="chapter" data-level="2.1" data-path="write-simple-queries.html"><a href="write-simple-queries.html#the-with-clause"><i class="fa fa-check"></i><b>2.1</b> The <code>WITH</code> clause</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>3</b> Filtering</a><ul>
<li class="chapter" data-level="3.1" data-path="filtering.html"><a href="filtering.html#the-where-clause"><i class="fa fa-check"></i><b>3.1</b> The <code>WHERE</code> clause</a></li>
<li class="chapter" data-level="3.2" data-path="filtering.html"><a href="filtering.html#operators"><i class="fa fa-check"></i><b>3.2</b> Operators</a><ul>
<li class="chapter" data-level="3.2.1" data-path="filtering.html"><a href="filtering.html#comparison-operators"><i class="fa fa-check"></i><b>3.2.1</b> Comparison operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="filtering.html"><a href="filtering.html#logical-operators"><i class="fa fa-check"></i><b>3.2.2</b> Logical operators</a></li>
<li class="chapter" data-level="3.2.3" data-path="filtering.html"><a href="filtering.html#other-relational-operators"><i class="fa fa-check"></i><b>3.2.3</b> Other relational operators</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="filtering.html"><a href="filtering.html#missing-values"><i class="fa fa-check"></i><b>3.3</b> Missing values</a><ul>
<li class="chapter" data-level="3.3.1" data-path="filtering.html"><a href="filtering.html#conditional-functions"><i class="fa fa-check"></i><b>3.3.1</b> Conditional functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="filtering.html"><a href="filtering.html#the-having-clause"><i class="fa fa-check"></i><b>3.4</b> The <code>HAVING</code> clause</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aggregating.html"><a href="aggregating.html"><i class="fa fa-check"></i><b>4</b> Aggregating</a><ul>
<li class="chapter" data-level="4.0.1" data-path="aggregating.html"><a href="aggregating.html#rowwise-aggregating"><i class="fa fa-check"></i><b>4.0.1</b> rowwise aggregating</a></li>
<li class="chapter" data-level="4.1" data-path="aggregating.html"><a href="aggregating.html#the-group-by-clause."><i class="fa fa-check"></i><b>4.1</b> The <code>GROUP BY</code> clause.</a></li>
<li class="chapter" data-level="4.2" data-path="aggregating.html"><a href="aggregating.html#common-aggregating-functions"><i class="fa fa-check"></i><b>4.2</b> Common aggregating functions</a></li>
<li class="chapter" data-level="4.3" data-path="aggregating.html"><a href="aggregating.html#null-values-in-aggregation"><i class="fa fa-check"></i><b>4.3</b> NULL values in aggregation</a></li>
<li class="chapter" data-level="4.4" data-path="aggregating.html"><a href="aggregating.html#using-group-by-in-non-aggregating-scenarios"><i class="fa fa-check"></i><b>4.4</b> Using <code>GROUP BY</code> in non-aggregating scenarios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="window-functions.html"><a href="window-functions.html"><i class="fa fa-check"></i><b>5</b> Window functions</a><ul>
<li class="chapter" data-level="5.1" data-path="window-functions.html"><a href="window-functions.html#statisticcs-with-window-functions"><i class="fa fa-check"></i><b>5.1</b> Statisticcs with window functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="joining.html"><a href="joining.html"><i class="fa fa-check"></i><b>6</b> Joining</a></li>
<li class="chapter" data-level="7" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>7</b> Data types</a><ul>
<li class="chapter" data-level="7.1" data-path="data-types.html"><a href="data-types.html#converting-data-types"><i class="fa fa-check"></i><b>7.1</b> Converting data types</a></li>
<li class="chapter" data-level="7.2" data-path="data-types.html"><a href="data-types.html#date-and-time"><i class="fa fa-check"></i><b>7.2</b> Date and time</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="solutions-to-sql-puzzles.html"><a href="solutions-to-sql-puzzles.html"><i class="fa fa-check"></i><b>8</b> Solutions to SQL puzzles</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li>
  <a href="https://github.com/rstudio/bookdown" target="blank">Written with bookdown</a>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Manipulation with SQL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-types" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Data types</h1>
<p>The notion of data types underpin endless possibilities for type-specific operations. For example, we could extract the year component from a date, yet the same operation does not make any sense when applied to a string. On the other hand, regular expressions are designed for string matching problems and cannot be adapted to date.</p>
<div id="converting-data-types" class="section level2">
<h2><span class="header-section-number">7.1</span> Converting data types</h2>
<p>There is no guarantee that SQL will always correctly recognize the right data type for columns. 2020-07-30 means a date, but can be imported as a string. Since type-specific operations are only defined for certain data types. It’s natural to think about converting some columnsn to the “right” data type. To change the data type of a column, we simply need to use the <code>column::datatype</code> format,
where column is the column name, and data type is the data type you want to change the column into.</p>
<p><code>::</code></p>
<p><code>CAST</code></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb34-1"><a href="data-types.html#cb34-1"></a><span class="kw">SELECT</span> shop, <span class="fu">SUM</span>((price <span class="kw">IS</span>  <span class="kw">NULL</span>):<span class="ch">:int</span>), <span class="fu">COUNT</span>(<span class="op">*</span>) </span>
<span id="cb34-2"><a href="data-types.html#cb34-2"></a><span class="kw">FROM</span> inventory</span>
<span id="cb34-3"><a href="data-types.html#cb34-3"></a><span class="kw">GROUP</span> <span class="kw">BY</span> shop</span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-1">Table 3.1: </span>2 records</caption>
<thead>
<tr class="header">
<th align="left">shop</th>
<th align="right">sum</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Board ’Em</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Dicey</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="date-and-time" class="section level2">
<h2><span class="header-section-number">7.2</span> Date and time</h2>
<p>To see your current date settings, you can use the following command:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb35-1"><a href="data-types.html#cb35-1"></a>SHOW DateStyle</span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-2">Table 3.2: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">DateStyle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ISO, MDY</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb36-1"><a href="data-types.html#cb36-1"></a><span class="kw">SET</span> DateStyle<span class="op">=</span><span class="st">&#39;ISO, MDY&#39;</span>;</span></code></pre></div>
<p>In addition to displaying dates that are input as strings, we can display the current date
very simply using the <code>current_date</code> keywords in Postgres.</p>
<p>Additionally, the SQL standard offers a TIMESTAMP data type. A
timestamp represents a date and a time, down to a microsecond. This can be displayed via the <code>current_timestamp</code> keyword or the <code>NOW()</code> function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb37-1"><a href="data-types.html#cb37-1"></a><span class="kw">SELECT</span> <span class="fu">current_date</span>, <span class="fu">current_timestamp</span>, NOW()</span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-4">Table 3.4: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="left">now</th>
<th align="left">now</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2020-07-30</td>
<td align="left">2020-07-30 11:39:36</td>
<td align="left">2020-07-30 11:39:36</td>
</tr>
</tbody>
</table>
</div>
<p>Often, we will want to decompose our dates into their component parts. For example,
we may be interested in only the year and month, but not the day, for the monthly
analysis of our data. To do this, we can use the syntax <code>EXTRACT(component FROM date)</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb38-1"><a href="data-types.html#cb38-1"></a><span class="kw">SELECT</span> <span class="fu">current_date</span>,</span>
<span id="cb38-2"><a href="data-types.html#cb38-2"></a>  <span class="fu">EXTRACT</span>(<span class="dt">year</span> <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">year</span>,</span>
<span id="cb38-3"><a href="data-types.html#cb38-3"></a>  <span class="fu">EXTRACT</span>(<span class="dt">month</span> <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">month</span>,</span>
<span id="cb38-4"><a href="data-types.html#cb38-4"></a>  <span class="fu">EXTRACT</span>(<span class="dt">day</span> <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">day</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-5">Table 3.5: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2020-07-30</td>
<td align="right">2020</td>
<td align="right">7</td>
<td align="right">30</td>
</tr>
</tbody>
</table>
</div>
<p>Similarly, we can abbreviate these components as <code>y,</code>mon<code>, and</code>d`,</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb39-1"><a href="data-types.html#cb39-1"></a><span class="kw">SELECT</span> <span class="fu">current_date</span>,</span>
<span id="cb39-2"><a href="data-types.html#cb39-2"></a>  <span class="fu">EXTRACT</span>(y <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">year</span>,</span>
<span id="cb39-3"><a href="data-types.html#cb39-3"></a>  <span class="fu">EXTRACT</span>(mon <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">month</span>,</span>
<span id="cb39-4"><a href="data-types.html#cb39-4"></a>  <span class="fu">EXTRACT</span>(d <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> <span class="dt">day</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-6">Table 3.6: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2020-07-30</td>
<td align="right">2020</td>
<td align="right">7</td>
<td align="right">30</td>
</tr>
</tbody>
</table>
</div>
<p>We can also extract components like day of the week, week of the year, or quarter. Note that <code>dow</code> and <code>isodow</code> use different standard to extract day-of-week component. <code>dow</code> starts at 0 (Sunday) and goes up to Saturday, while <code>isodow</code> which starts at
1 (Monday) and goes up to 7 (Sunday)</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb40-1"><a href="data-types.html#cb40-1"></a><span class="kw">SELECT</span> <span class="fu">current_date</span>,</span>
<span id="cb40-2"><a href="data-types.html#cb40-2"></a>  <span class="fu">EXTRACT</span>(isodow <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> day_of_week,</span>
<span id="cb40-3"><a href="data-types.html#cb40-3"></a>  <span class="fu">EXTRACT</span>(week <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> week_of_year,</span>
<span id="cb40-4"><a href="data-types.html#cb40-4"></a>  <span class="fu">EXTRACT</span>(quarter <span class="kw">FROM</span> <span class="fu">current_date</span>) <span class="kw">AS</span> quarter</span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-7">Table 3.7: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">day_of_week</th>
<th align="right">week_of_year</th>
<th align="right">quarter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2020-07-30</td>
<td align="right">4</td>
<td align="right">31</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="joining.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="solutions-to-sql-puzzles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/data-manipulation-sql/edit/master/data-types.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
